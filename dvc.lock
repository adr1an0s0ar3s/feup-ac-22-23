schema: '2.0'
stages:
  migrate_database_to_sql:
    cmd: sqlite3 data/database.db -batch -init src/sql/init.sql
    deps:
    - path: data/account.csv
      md5: ef0f49c7954bbbfc783ea36a735b25e1
      size: 156340
    - path: data/card_dev.csv
      md5: 7aaa57fe06bd39e81fa7dba9a9d27fb3
      size: 4328
    - path: data/client.csv
      md5: 487458958bfdc1040ec8fd3fd4f6c01b
      size: 94820
    - path: data/disp.csv
      md5: d6d137e58d95b0522ce284bcecb1c2c9
      size: 129716
    - path: data/district.csv
      md5: 14aa6edfb2fa331dcd98aed1256b6d65
      size: 6642
    - path: data/loan_dev.csv
      md5: 92611660fdf3cffd844726e59360d764
      size: 11424
    - path: data/trans_dev.csv
      md5: c6f59a61bdc6227463d27b28727d2a14
      size: 33243199
    - path: src/sql/create.sql
      md5: a14005c0d44ccef3cb9b97755807f121
      size: 382
    - path: src/sql/init.sql
      md5: 8b8563c2b6482e0eb34de27c9db3c670
      size: 129
    outs:
    - path: data/database.db
      md5: 8216bf4ee95d6e069819a693d4b72b52
      size: 376832
  create_database:
    cmd: sqlite3 data/database.db < src/sql/init.sql
    deps:
    - path: data/account.csv
      md5: ef0f49c7954bbbfc783ea36a735b25e1
      size: 156340
    - path: data/card_dev.csv
      md5: 7aaa57fe06bd39e81fa7dba9a9d27fb3
      size: 4328
    - path: data/client.csv
      md5: 487458958bfdc1040ec8fd3fd4f6c01b
      size: 94820
    - path: data/disp.csv
      md5: d6d137e58d95b0522ce284bcecb1c2c9
      size: 129716
    - path: data/district.csv
      md5: 14aa6edfb2fa331dcd98aed1256b6d65
      size: 6642
    - path: data/loan_dev.csv
      md5: 92611660fdf3cffd844726e59360d764
      size: 11424
    - path: data/trans_dev.csv
      md5: c6f59a61bdc6227463d27b28727d2a14
      size: 33243199
    - path: src/sql/create.sql
      md5: 8c3e35359cf1324bf1534d5077c84f58
      size: 2359
    - path: src/sql/init.sql
      md5: 65b3f3235365fe21883eefd547fc5635
      size: 340
    outs:
    - path: data/database.db
      md5: 17d7f638917887d4c5b3dc2121e03827
      size: 35721216
  process-data:
    cmd: python3 src/process_data.py
    deps:
    - path: data/database.db
      md5: 17d7f638917887d4c5b3dc2121e03827
      size: 35721216
    - path: src/process_data.py
      md5: 60cbd8b96693588f1d7ca25d35c2bffe
      size: 275
    outs:
    - path: data/processed_data.csv
      md5: 1001b78795b07b9a5224f2652f77ee1c
      size: 9448
  split-data:
    cmd: python3 src/split_data.py
    deps:
    - path: data/processed_data.csv
      md5: 1001b78795b07b9a5224f2652f77ee1c
      size: 9448
    - path: src/split_data.py
      md5: 5a51b00196ae1ffb2e0542a59f28a1d7
      size: 691
    outs:
    - path: data/X_train.csv
      md5: ca946d5fa1ccbe3fefdbb42350cb16e5
      size: 6563
    - path: data/y_train.csv
      md5: c7a4db2f05aa2839345903c46c8022be
      size: 540
  train-model:
    cmd: python3 src/train_model.py
    deps:
    - path: data/X_test.csv
      md5: c65673f496d4db24f6334d66333df341
      size: 2216
    - path: data/X_train.csv
      md5: ca946d5fa1ccbe3fefdbb42350cb16e5
      size: 6563
    - path: data/y_test.csv
      md5: 63a4fa69a15d2bf4f4def1d9423f4404
      size: 176
    - path: data/y_train.csv
      md5: c7a4db2f05aa2839345903c46c8022be
      size: 540
    - path: src/train_model.py
      md5: 488ae9896debd0d2a747ccebe9635d7a
      size: 701
    params:
      params.yaml:
        train.max_depth: 25
    outs:
    - path: data/model.joblib
      md5: ac979086c317616163cb19472a7b56be
      size: 7721
  test-model:
    cmd: python3 src/test_model.py
    deps:
    - path: data/X_test.csv
      md5: c65673f496d4db24f6334d66333df341
      size: 2216
    - path: data/model.joblib
      md5: ac979086c317616163cb19472a7b56be
      size: 7721
    - path: data/y_test.csv
      md5: 63a4fa69a15d2bf4f4def1d9423f4404
      size: 176
    - path: src/test_model.py
      md5: 68a8d70f7065ed0debd74bdc5e2f22ef
      size: 2147
    outs:
    - path: evaluation/plots/precision_recall.json
      md5: 9ee8937cb86264d2cb71f33dc680be2d
      size: 268
    - path: evaluation/plots/roc.json
      md5: b9eb144a69dfa6585cc238824d1d4e10
      size: 330
    - path: metrics/results.json
      md5: ff959adc0f45729a6699091a5a0fbde7
      size: 135
