schema: '2.0'
stages:
  create-database:
    cmd: sqlite3 data/database.db ".read src/sql/init.sql" ".read src/sql/create_data_integration_views.sql"
      ".read src/sql/create_data_feature_engineering_views.sql"
    deps:
    - path: data/card_dev.csv
      md5: 7aaa57fe06bd39e81fa7dba9a9d27fb3
      size: 4328
    - path: data/client.csv
      md5: 487458958bfdc1040ec8fd3fd4f6c01b
      size: 94820
    - path: data/disp.csv
      md5: d6d137e58d95b0522ce284bcecb1c2c9
      size: 129716
    - path: data/district.csv
      md5: 14aa6edfb2fa331dcd98aed1256b6d65
      size: 6642
    - path: data/loan_dev.csv
      md5: 92611660fdf3cffd844726e59360d764
      size: 11424
    - path: data/trans_dev.csv
      md5: c6f59a61bdc6227463d27b28727d2a14
      size: 33243199
    - path: src/sql/create.sql
      md5: 69ec60d64e4b69715cc3564fc8f004cc
      size: 2350
    - path: src/sql/create_data_feature_engineering_views.sql
      md5: fcd774b01c670cfcc44da71f4aec5984
      size: 9748
    - path: src/sql/create_data_integration_views.sql
      md5: e1922dfc24abcb531fdf42b05da83664
      size: 1673
    - path: src/sql/init.sql
      md5: 65b3f3235365fe21883eefd547fc5635
      size: 340
    outs:
    - path: data/database.db
      md5: 9ae870fee84dd3e03b6e978110a7092c
      size: 35737600
  unify-data:
    cmd: python3 src/unify_data.py
    deps:
    - path: data/database.db
      md5: 9ae870fee84dd3e03b6e978110a7092c
      size: 35737600
    - path: src/unify_data.py
      md5: ee1294c54d0b120e0e56a78dd448ecf4
      size: 2710
    outs:
    - path: data/unified_data.csv
      md5: ca9956efd6d671d8582cd2a54fa69dea
      size: 81115
  clean-redundancy:
    cmd: python3 src/data-cleaning/redundancy.py
    deps:
    - path: data/unified_data.csv
      md5: ca9956efd6d671d8582cd2a54fa69dea
      size: 81115
    - path: src/data-cleaning/redundancy.py
      md5: c35531d349652dff80844f85278cf44a
      size: 168
    outs:
    - path: data/clean_data0.csv
      md5: 81e67dc821872c8994702cce011f2c29
      size: 80845
  clean-missing-data:
    cmd: python3 src/data-cleaning/missing_data.py
    deps:
    - path: data/clean_data0.csv
      md5: 81e67dc821872c8994702cce011f2c29
      size: 80845
    - path: src/data-cleaning/missing_data.py
      md5: d789030e5611ddbf48b8f2a03b5d2fa6
      size: 810
    outs:
    - path: data/clean_data1.csv
      md5: 0531f4a5eed6e0c73e10c40b99344c1a
      size: 82404
  clean-outliers:
    cmd: python3 src/data-cleaning/outliers.py
    deps:
    - path: data/clean_data1.csv
      md5: 0531f4a5eed6e0c73e10c40b99344c1a
      size: 82404
    - path: src/data-cleaning/outliers.py
      md5: 75d1b1f667b4366847d9c6b3b826524b
      size: 166
    outs:
    - path: data/clean_data.csv
      md5: 0531f4a5eed6e0c73e10c40b99344c1a
      size: 82404
  transform-data:
    cmd: python3 src/data_transformation.py
    deps:
    - path: data/clean_data.csv
      md5: 0531f4a5eed6e0c73e10c40b99344c1a
      size: 82404
    - path: src/data_transformation.py
      md5: f7f3b3b0975cc681e6ab918ad1f92a5f
      size: 998
    outs:
    - path: data/prepared_data.csv
      md5: 44a7f0d0750436cd3595621fc40a0056
      size: 335277
    - path: data/scaler.joblib
      md5: 92c9402c23e0bc7f643ac84c3783fa8c
      size: 3426
  split-data:
    cmd: python3 src/split_data.py
    deps:
    - path: data/prepared_data.csv
      md5: 44a7f0d0750436cd3595621fc40a0056
      size: 335277
    - path: src/split_data.py
      md5: 4d520cea3c96c3589a26773aa342a4b7
      size: 1107
    outs:
    - path: data/X_test_all_features.csv
      md5: e592b7b97ebdb87f6f1673a50d4ef7c7
      size: 66592
    - path: data/X_train_not_sampled.csv
      md5: 879a310fcd68153a98abab204a8b7225
      size: 261713
    - path: data/y_test.csv
      md5: c5fb61bc3ed0ddbbf8f03a48748d59b6
      size: 139
    - path: data/y_train_not_sampled.csv
      md5: ad20a8766930f7e0dd04bae58e772a57
      size: 531
  sample-data:
    cmd: python3 src/sample_data.py
    deps:
    - path: data/X_train_not_sampled.csv
      md5: 879a310fcd68153a98abab204a8b7225
      size: 261713
    - path: data/y_train_not_sampled.csv
      md5: ad20a8766930f7e0dd04bae58e772a57
      size: 531
    - path: src/sample_data.py
      md5: 458fdedd116136a1f0210f9ee19bcc99
      size: 499
    outs:
    - path: data/X_train_all_features.csv
      md5: dfed4cf8313a60bb67ceadbe090a9b7b
      size: 443096
    - path: data/y_train.csv
      md5: 3043f97501976c316162dfd7ca2be46b
      size: 891
  select-features:
    cmd: python3 src/feature_selection.py
    deps:
    - path: data/X_test_all_features.csv
      md5: e592b7b97ebdb87f6f1673a50d4ef7c7
      size: 66592
    - path: data/X_train_all_features.csv
      md5: dfed4cf8313a60bb67ceadbe090a9b7b
      size: 443096
    - path: data/y_train.csv
      md5: 3043f97501976c316162dfd7ca2be46b
      size: 891
    - path: src/feature_selection.py
      md5: 6d5b906048b09b307321497cf9b20cd1
      size: 2947
    params:
      params.yaml:
        feature_selection:
          filter: variance
          wrapper: forward
          estimator: perceptron
        manual_feature_selection: false
        manual_feature_selection_fields:
        - balance
        - timesIntoNegativeBalance
        - numTransactionsNegBalance
    outs:
    - path: data/X_test.csv
      md5: 7e7b8dd4fc5004133ea853d72d251830
      size: 32512
    - path: data/X_train.csv
      md5: c3632c1e35875aafcb889a0f5cd65390
      size: 215345
    - path: data/features.csv
      md5: b83150b5fc64a84ecc5e2ec11d8f5445
      size: 463
  train-model:
    cmd: python3 src/train_model.py
    deps:
    - path: data/X_test.csv
      md5: 7e7b8dd4fc5004133ea853d72d251830
      size: 32512
    - path: data/X_train.csv
      md5: c3632c1e35875aafcb889a0f5cd65390
      size: 215345
    - path: data/y_test.csv
      md5: c5fb61bc3ed0ddbbf8f03a48748d59b6
      size: 139
    - path: data/y_train.csv
      md5: 3043f97501976c316162dfd7ca2be46b
      size: 891
    - path: src/train_model.py
      md5: 430ec360ef012bcc42c3349f68317a58
      size: 3523
    params:
      params.yaml:
        classifiers:
        - knn
        params: {}
    outs:
    - path: data/model.joblib
      md5: 955ac5371ec90a69af90b5fdb59d358e
      size: 193264
    - path: metrics/model_details.json
      md5: 86eb572b5792f2924e6f42811a7fc244
      size: 231
  test-model:
    cmd: python3 src/test_model.py
    deps:
    - path: data/X_test.csv
      md5: 7e7b8dd4fc5004133ea853d72d251830
      size: 32512
    - path: data/model.joblib
      md5: 955ac5371ec90a69af90b5fdb59d358e
      size: 193264
    - path: data/y_test.csv
      md5: c5fb61bc3ed0ddbbf8f03a48748d59b6
      size: 139
    - path: src/test_model.py
      md5: 05f5f8f628a3b9bddb9f8024a8dc8332
      size: 2075
    outs:
    - path: evaluation/plots/precision_recall.json
      md5: 3237df4518ca1e8a60449d34ec5d0d1b
      size: 4820
    - path: metrics/results.json
      md5: 98066e0fa9c56e7f5e40f7bc4d66a16e
      size: 142
  clustering:
    cmd: python3 src/cluster_data.py
    deps:
    - path: data/prepared_data.csv
      md5: 44a7f0d0750436cd3595621fc40a0056
      size: 335277
    - path: data/scaler.joblib
      md5: 92c9402c23e0bc7f643ac84c3783fa8c
      size: 3426
    - path: src/cluster_data.py
      md5: d3ccfdabb71f7a08a14e96bec0c0c6bd
      size: 639
